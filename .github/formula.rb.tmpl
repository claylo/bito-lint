# typed: true
# frozen_string_literal: true

class BitoLint < Formula
  desc "__DESCRIPTION__"
  homepage "__HOMEPAGE__"
  version "__VERSION__"
  license "__LICENSE__"

  on_macos do
    if Hardware::CPU.arm?
      url "__RELEASE_URL__/__PROJECT__-#{version}-aarch64-apple-darwin.tar.gz"
      sha256 "__SHA_DARWIN_ARM64__"
    else
      url "__RELEASE_URL__/__PROJECT__-#{version}-x86_64-apple-darwin.tar.gz"
      sha256 "__SHA_DARWIN_X64__"
    end
  end

  on_linux do
    if Hardware::CPU.arm?
      url "__RELEASE_URL__/__PROJECT__-#{version}-aarch64-unknown-linux-gnu.tar.gz"
      sha256 "__SHA_LINUX_ARM64__"
    else
      url "__RELEASE_URL__/__PROJECT__-#{version}-x86_64-unknown-linux-gnu.tar.gz"
      sha256 "__SHA_LINUX_X64__"
    end
  end

  def install
    bin.install "bin/__PROJECT__"
    man1.install Dir["share/man/man1/*.1"]
    bash_completion.install "share/completions/__PROJECT__.bash" => "__PROJECT__"
    zsh_completion.install "share/completions/___PROJECT__"
    fish_completion.install "share/completions/__PROJECT__.fish"
  end

  test do
    assert_match version.to_s, shell_output("\#{bin}/__PROJECT__ --version-only")
  end
end
